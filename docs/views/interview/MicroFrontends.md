---
title: 微前端
config : {
    dir : true
}
password: true
---

### qiankun2.0

#### 1."沙箱"是什么？

沙箱 (Sandboxie) ，又叫沙盘，即是一个虚拟系统程序，允许你在沙盘环境中运行浏览器或其他程序，因此运行所产生的变化可以随后删除。它创造了一个类似沙盒的独立作业环境，在其内部运行的程序并不能对硬盘产生永久性的影响。 在网络安全中，沙箱指在隔离环境中，用以测试不受信任的文件或应用程序等行为的工具

在qiankun里，其实就是解决微前端中的隔离问题，它实现了一个叫做->运行时沙箱<-的东西

#### 2."沙箱"是如何实现的？

简单来说，分为->js沙箱<-、->样式沙箱<-

##### js沙箱

通过 ->proxy<- 代理 ->window<- 对象，记录 ->window<- 对象上属性的增删改查

+ 单例模式

> 直接代理了原生 window 对象，记录原生 window 对象的增删改查，当 window 对象激活时恢复 window 对象到上次即将失活时的状态，失活时恢复 window 对象到初始初始状态

+ 多例模式

> 代理了一个全新的对象，这个对象是复制的 window 对象的一部分不可配置属性，所有的更改都是基于这个 fakeWindow 对象，从而保证多个实例之间属性互不影响

将这个 ->proxy<- 作为微应用的全局对象，所有的操作都在这个 ->proxy<- 对象上，这就是 JS 沙箱的原理

##### css沙箱

利用了->Shadow DOM<-影子节点，可以将一个隐藏的、独立的 DOM 附加到一个元素上，一般来说是微应用的容器，以及运用了->Scoped CSS 隔离<-来实现css沙箱（添加css属性）

