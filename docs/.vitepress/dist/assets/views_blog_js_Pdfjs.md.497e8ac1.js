import{_ as s,c as a,o as l,V as n}from"./chunks/framework.79590ae5.js";const C=JSON.parse('{"title":"pdf.js使用和JS实现嵌套Iframe页面F11全屏效果","description":"","frontmatter":{"date":"2020-04-02 10:58","config":{"top":false,"dir":false,"tag":["js","info"],"valine":true,"valineId":"/blog/js/Pdfjs.html"},"title":"pdf.js使用和JS实现嵌套Iframe页面F11全屏效果"},"headers":[],"relativePath":"views/blog/js/Pdfjs.md"}'),o={name:"views/blog/js/Pdfjs.md"},p=n(`<h3 id="_1-pdf-js使用" tabindex="-1">1. Pdf.js使用 <a class="header-anchor" href="#_1-pdf-js使用" aria-label="Permalink to &quot;1. Pdf.js使用&quot;">​</a></h3><p><code class="default">generic/web/viewer.html</code>主要是渲染pdf阅读器的样式，而<code class="default">generic/web/viewer.js</code>则是指定打开的pdf文件（当然还有其他功能，不过这些都不是我们关心的），我们看位于<code class="default">generic/web/viewer.js</code>的一段代码：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> DEFAULT_URL </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">20802.pdf</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>我们可以看到，他默认打开<code class="default">generic/web/20802.pdf.pdf</code>文件，再来看下面这段代码：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> inparams </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> params</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">file </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> DEFAULT_URL</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>这就告诉我们，可以通过传递<code class="default">file</code>形参来动态指定打开的pdf文件！如：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">http</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//localhost:8080/generic/web/viewer.html?file=qbs.pdf</span></span></code></pre></div><p>下面我就介绍下，具体嵌入项目中是如何运用的！</p><p>可以把generic中的内容作为第三方插件进行使用，</p><p>然后页面可以使用<code class="default">iframe</code>标签来加载pdf</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">iframesrc</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;c:urlvalue=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">resources</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">plugin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">pdfJs</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">generic</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">web</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">viewer</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">html</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/&gt;?file=&lt;c:url value=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">publicity</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">displayPDF</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">do</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> /&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">width</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">100%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> height</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">100%</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>实质就是我们直接访问<code class="default">generic/web/viewer.html</code>，然后为其指定一个<code class="default">file</code>形参，用于指定打开的<code class="default">pdf</code>文件！我上面使用的流的方式进行指定的。</p><h3 id="_2-js实现嵌套iframe页面f11全屏效果" tabindex="-1">2. JS实现嵌套Iframe页面F11全屏效果 <a class="header-anchor" href="#_2-js实现嵌套iframe页面f11全屏效果" aria-label="Permalink to &quot;2. JS实现嵌套Iframe页面F11全屏效果&quot;">​</a></h3><p>前面用<code class="default">iframe</code>实现了嵌套<code class="default">pdf.js</code>但是你能够发现全屏按钮没有了</p><p>那是因为<code class="default">ifram</code>中不能实现全屏功能</p><p>但在HTML5中,W3C制定了关于全屏的API，就可以实现全屏幕的效果</p><p>项目中需要将后台浏览器的窗口全屏，也就是我们点击一个按钮要实现按F11全屏的效果。 在HTML5中,W3C制定了关于全屏的API，就可以实现全屏幕的效果，也可以让页面中的图片，视频等全屏目前只有googlechrome 15 +, safri5.1+,firfox10+,IE11支持</p><p>实现：也是在<code class="default">webViewerInitialized</code>函数中绑定id为<code class="default">presentationMode</code>的button点击事件</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">presentationMode</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">vardocElm</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">documentElement</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//W3C</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">requestFullscreen</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">requestFullscreen</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//FireFox</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">mozRequestFullScreen</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mozRequestFullScreen</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//Chrome等</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">webkitRequestFullScreen</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">webkitRequestFullScreen</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//IE11</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">msRequestFullscreen</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">docElm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">msRequestFullscreen</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>其中</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">PDFViewerApplication</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">supportsFullscreen) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">presentationMode</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">classList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">secondaryPresentationMode</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#A6ACCD;">classList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hidden</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>判断是否显示全屏按钮，我是把他隐藏的js去掉，也可以进一步的完善</p><p>另外：在 用IE11的时候全屏有可能不能显示全部pdf文件这样只需在viewer.html中<code class="default">&lt;htmldir=&quot;ltr&quot; mozdisallowselectionprint moznomarginboxesstyle=&quot;width: 100%&quot;&gt;</code>宽度设为100%</p><p>将<code class="default">iframe</code>标签内加上一个 <code class="default">allowFullScreen=true</code> 也是可行的</p>`,24),e=[p];function t(c,r,F,D,y,i){return l(),a("div",null,e)}const A=s(o,[["render",t]]);export{C as __pageData,A as default};
